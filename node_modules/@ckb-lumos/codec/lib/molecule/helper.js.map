{"version":3,"file":"helper.js","names":["byteArrayOf","codec","byteLength","createFixedBytesCodec","pack","packable","unpack","buf","byteOf","byteVecOf","createBytesCodec","unpacked","payload","header","Uint32LE","concat","packed","assertMinBufferLength","slice","assertBufferLength"],"sources":["../../src/molecule/helper.ts"],"sourcesContent":["import { assertBufferLength, assertMinBufferLength } from \"../utils\";\nimport { concat } from \"../bytes\";\nimport {\n  BytesCodec,\n  createBytesCodec,\n  createFixedBytesCodec,\n  FixedBytesCodec,\n} from \"../base\";\nimport { Uint32LE } from \"../number\";\n\n/**\n * a helper function to create custom codec of `array SomeType [byte; n]`\n * @param codec\n */\nexport function byteArrayOf<Packed, Packable = Packed>(\n  codec: BytesCodec<Packed, Packable> & { byteLength: number }\n): FixedBytesCodec<Packed, Packable> {\n  const byteLength = codec.byteLength;\n  return createFixedBytesCodec({\n    byteLength,\n    pack: (packable) => codec.pack(packable),\n    unpack: (buf) => codec.unpack(buf),\n  });\n}\n\n/**\n * a helper function to create custom codec of `byte`\n * @param codec\n */\nexport function byteOf<Packed, Packable = Packed>(\n  codec: BytesCodec<Packed, Packable>\n): FixedBytesCodec<Packed, Packable> {\n  return byteArrayOf({ ...codec, byteLength: 1 });\n}\n\n/**\n * a helper function to create custom codec of `vector Bytes <byte>`\n * @param codec\n */\nexport function byteVecOf<Packed, Packable = Packed>(\n  codec: BytesCodec<Packed, Packable>\n): BytesCodec<Packed, Packable> {\n  return createBytesCodec({\n    pack(unpacked) {\n      const payload = codec.pack(unpacked);\n      const header = Uint32LE.pack(payload.byteLength);\n\n      return concat(header, payload);\n    },\n    unpack(packed) {\n      assertMinBufferLength(packed, 4);\n      const header = Uint32LE.unpack(packed.slice(0, 4));\n      assertBufferLength(packed.slice(4), header);\n      return codec.unpack(packed.slice(4));\n    },\n  });\n}\n"],"mappings":";;;;;;;;;AAAA;;AACA;;AACA;;AAMA;;AAEA;AACA;AACA;AACA;AACO,SAASA,WAAT,CACLC,KADK,EAE8B;EACnC,MAAMC,UAAU,GAAGD,KAAK,CAACC,UAAzB;EACA,OAAO,IAAAC,2BAAA,EAAsB;IAC3BD,UAD2B;IAE3BE,IAAI,EAAGC,QAAD,IAAcJ,KAAK,CAACG,IAAN,CAAWC,QAAX,CAFO;IAG3BC,MAAM,EAAGC,GAAD,IAASN,KAAK,CAACK,MAAN,CAAaC,GAAb;EAHU,CAAtB,CAAP;AAKD;AAED;AACA;AACA;AACA;;;AACO,SAASC,MAAT,CACLP,KADK,EAE8B;EACnC,OAAOD,WAAW,CAAC,EAAE,GAAGC,KAAL;IAAYC,UAAU,EAAE;EAAxB,CAAD,CAAlB;AACD;AAED;AACA;AACA;AACA;;;AACO,SAASO,SAAT,CACLR,KADK,EAEyB;EAC9B,OAAO,IAAAS,sBAAA,EAAiB;IACtBN,IAAI,CAACO,QAAD,EAAW;MACb,MAAMC,OAAO,GAAGX,KAAK,CAACG,IAAN,CAAWO,QAAX,CAAhB;;MACA,MAAME,MAAM,GAAGC,gBAAA,CAASV,IAAT,CAAcQ,OAAO,CAACV,UAAtB,CAAf;;MAEA,OAAO,IAAAa,aAAA,EAAOF,MAAP,EAAeD,OAAf,CAAP;IACD,CANqB;;IAOtBN,MAAM,CAACU,MAAD,EAAS;MACb,IAAAC,4BAAA,EAAsBD,MAAtB,EAA8B,CAA9B;;MACA,MAAMH,MAAM,GAAGC,gBAAA,CAASR,MAAT,CAAgBU,MAAM,CAACE,KAAP,CAAa,CAAb,EAAgB,CAAhB,CAAhB,CAAf;;MACA,IAAAC,yBAAA,EAAmBH,MAAM,CAACE,KAAP,CAAa,CAAb,CAAnB,EAAoCL,MAApC;MACA,OAAOZ,KAAK,CAACK,MAAN,CAAaU,MAAM,CAACE,KAAP,CAAa,CAAb,CAAb,CAAP;IACD;;EAZqB,CAAjB,CAAP;AAcD"}